(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"9ZZK":function(t,e,a){"use strict";a.r(e);var s={data:function(){return{userItems:{data:[],page:1,perPage:25,total:0,lastPage:1},fields:[{key:"#",thStyle:{width:"40px"},class:"text-center"},{key:"username",sortable:!0,label:this.trans("common.username"),thClass:"text-center"},{key:"status",sortable:!0,label:this.trans("common.status"),class:"table-col-status"},{key:"role",sortable:!0,label:this.trans("common.role"),thClass:"text-center",thStyle:{minWidth:"190px"}},{key:"updated_at",sortable:!0,label:this.trans("common.updated_at"),class:"table-col-time"},{key:"created_at",sortable:!0,label:this.trans("common.created_at"),class:"table-col-time"}],isLoading:!1,searchData:{account:"",status:"all",roles:[],page:1,perPage:25},roleOptions:this.getJsonData("role-list")}},mounted:function(){var t=this;this.roleOptions.forEach(function(e){t.searchData.roles.push(e.id)}),this.search()},methods:{search:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25;this.isLoading||(this.isLoading=!0,this.searchData.page=e,this.searchData.perPage=Number(a),this.$ajax("POST","/api/accounts/user/list",this.searchData).then(function(e){t.userItems=e,t.isLoading=!1}).catch(function(t){console.error(t)}))},roleOnChange:function(t){var e=this;this.searchData.roles=[];var a=t.target.value;a?this.searchData.roles.push(a):this.roleOptions.forEach(function(t){e.searchData.roles.push(t.id)})},updateUserRoleDialog:function(t,e){var a=this;this.$bvModal.msgBoxConfirm(this.trans("users."+e.role)+" => "+this.trans("users."+t)+"?",{okTitle:this.trans("common.ok"),cancelTitle:this.trans("common.cancel")}).then(function(s){s?a.updateUserRole(t,e.id):document.getElementById("role-"+e.id).value=e.role}).catch(function(t){console.warn(t)})},updateUserRole:function(t,e){var a=this;this.$ajax("POST","/api/accounts/user/update-user-role",{role:t,id:e}).then(function(s){a.userItems.data.filter(function(t){return t.id==e})[0].role=t}).catch(function(t){console.error(t)})},updateAllUser:function(){var t=this;this.isLoading=!0,axios.get("/api/accounts/user/update-all-user").then(function(e){t.isLoading=!1,t.search()}).catch(function(t){console.error(t)})},enabled:function(t,e){var a=this;this.$ajax("POST","/api/accounts/user/toggle-enabled",{id:t,enabled:e}).then(function(s){a.userItems.data.filter(function(e){return e.id==t})[0].status=e}).catch(function(t){console.error(t)})}}},n=a("KHd+"),r=Object(n.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("list-grid",{attrs:{data:t.userItems,search:t.search}},[a("template",{slot:"search-form"},[t.user.isAdmin?a("a",{staticClass:"btn btn-info mr-2 mb-1",on:{click:function(e){return t.updateAllUser()}}},[t._v(t._s(t.trans("users.update-all-user")))]):t._e(),t._v(" "),a("b-input-group",{staticClass:"mr-2 mb-1",attrs:{prepend:t.trans("common.account")}},[a("b-form-input",{attrs:{type:"text"},model:{value:t.searchData.account,callback:function(e){t.$set(t.searchData,"account",e)},expression:"searchData.account"}})],1),t._v(" "),a("b-input-group",{staticClass:"mr-2 mb-1",attrs:{prepend:t.trans("common.status")}},[a("b-form-select",{model:{value:t.searchData.status,callback:function(e){t.$set(t.searchData,"status",e)},expression:"searchData.status"}},[a("option",{attrs:{value:"all"}},[t._v(t._s(t.trans("common.all")))]),t._v(" "),a("option",{attrs:{value:"1"}},[t._v(t._s(t.trans("common.active")))]),t._v(" "),a("option",{attrs:{value:"0"}},[t._v(t._s(t.trans("common.suspended")))])])],1),t._v(" "),a("b-input-group",{staticClass:"mr-2 mb-1",attrs:{prepend:t.trans("common.role")}},[a("b-form-select",{attrs:{value:""},nativeOn:{change:function(e){return t.roleOnChange(e)}}},[a("option",{attrs:{value:""}},[t._v(t._s(t.trans("common.all")))]),t._v(" "),t._l(t.roleOptions,function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                                "+t._s(e.name)+"\n                        ")])})],2)],1)],1),t._v(" "),a("template",{slot:"table"},[a("b-table",{attrs:{responsive:"",bordered:"",striped:"",small:"",items:t.userItems.data,fields:t.fields,busy:t.isLoading,"show-empty":"","empty-text":t.trans("common.empty-data")},scopedSlots:t._u([{key:"#",fn:function(e){return[t._v("\n                        "+t._s(e.index+1+t.userItems.perPage*(t.userItems.page-1))+"\n                    ")]}},{key:"status",fn:function(e){return[a("button",{class:"btn-pill btn-sm btn-"+(e.item.status?"success":"danger"),on:{click:function(a){return t.enabledDialog(e.item.id,e.item.username,e.item.status,t.enabled)}}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.trans("common."+(e.item.status?"active":"suspended")))+"\n\t\t\t\t\t\t")])]}},{key:"role",fn:function(e){return[a("b-form-select",{attrs:{id:"role-"+e.item.id,value:e.item.role},nativeOn:{change:function(a){return t.updateUserRoleDialog(a.target.value,e.item)}}},t._l(t.roleOptions,function(s){return a("option",{key:s.id,attrs:{disabled:e.item.role==s.name},domProps:{value:s.name}},[t._v("\n                                    "+t._s(t.trans("users."+s.name))+"\n                            ")])}),0)]}}])},[a("loading",{attrs:{slot:"table-busy"},slot:"table-busy"})],1)],1)],2)],1)},[],!1,null,null,null);e.default=r.exports}}]);